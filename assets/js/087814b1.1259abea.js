"use strict";(self.webpackChunkhysteria_orm_docs=self.webpackChunkhysteria_orm_docs||[]).push([[6246],{7902:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"databases/sql/models/annotations","title":"Model Annotations","description":"Every Model instance can have an $annotations field containing computed columns, aggregations, or joined fields that aren\'t part of the Model definition.","source":"@site/docs/databases/sql/models/annotations.md","sourceDirName":"databases/sql/models","slug":"/databases/sql/models/annotations","permalink":"/hysteria-orm/docs/databases/sql/models/annotations","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/hysteria-orm/tree/main/website/docs/databases/sql/models/annotations.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Model Annotations","sidebar_position":2}}');var a=t(4848),s=t(8453);const i={title:"Model Annotations",sidebar_position:2},r="Model Annotations",l={},d=[{value:"How Annotations Work",id:"how-annotations-work",level:2},{value:"Annotation Signatures",id:"annotation-signatures",level:2},{value:"Combining with Select",id:"combining-with-select",level:2},{value:"Removing Annotations",id:"removing-annotations",level:2},{value:"Type Safety",id:"type-safety",level:2}];function c(n){const e={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"model-annotations",children:"Model Annotations"})}),"\n",(0,a.jsxs)(e.p,{children:["Every Model instance can have an ",(0,a.jsx)(e.code,{children:"$annotations"})," field containing computed columns, aggregations, or joined fields that aren't part of the Model definition."]}),"\n",(0,a.jsx)(e.h2,{id:"how-annotations-work",children:"How Annotations Work"}),"\n",(0,a.jsxs)(e.p,{children:["Use the ",(0,a.jsx)(e.code,{children:"annotate()"})," method to add non-model columns to your query results:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'// annotate(sqlFunction, column, alias)\nconst user = await User.query()\n  .annotate("count", "id", "total")\n  .first();\n\nconsole.log(user.$annotations.total); // number\n'})}),"\n",(0,a.jsx)(e.h2,{id:"annotation-signatures",children:"Annotation Signatures"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'// SQL function with column\n.annotate("count", "id", "userCount")    // COUNT(id) AS userCount\n.annotate("max", "age", "maxAge")        // MAX(age) AS maxAge\n.annotate("avg", "salary", "avgSalary")  // AVG(salary) AS avgSalary\n\n// Column alias only\n.annotate("id", "userId")                // id AS userId\n'})}),"\n",(0,a.jsx)(e.h2,{id:"combining-with-select",children:"Combining with Select"}),"\n",(0,a.jsxs)(e.p,{children:["When using ",(0,a.jsx)(e.code,{children:"annotate"})," alone without ",(0,a.jsx)(e.code,{children:"select"}),", model fields are omitted:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"// Only annotation - model fields not included\nconst r1 = await User.query()\n  .annotate('count', '*', 'total')\n  .first();\n// Result: { $annotations: { total: number } }\n\n// With select('*') - includes model fields + annotation\nconst r2 = await User.query()\n  .select('*')\n  .annotate('count', '*', 'total')\n  .first();\n// Result: User & { $annotations: { total: number } }\n"})}),"\n",(0,a.jsx)(e.h2,{id:"removing-annotations",children:"Removing Annotations"}),"\n",(0,a.jsxs)(e.p,{children:["Remove the ",(0,a.jsx)(e.code,{children:"$annotations"})," property from results:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:"const user = await User.query()\n  .removeAnnotations()\n  .first();\n// Result: User (no $annotations)\n"})}),"\n",(0,a.jsx)(e.h2,{id:"type-safety",children:"Type Safety"}),"\n",(0,a.jsx)(e.p,{children:"Annotations are type-safe in ModelQueryBuilder:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-typescript",children:'const user = await User.query()\n  .annotate("count", "id", "total")\n  .first();\n\n// TypeScript knows $annotations.total exists\nconsole.log(user.$annotations.total);\n'})}),"\n",(0,a.jsx)(e.admonition,{type:"note",children:(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.code,{children:"selectRaw"})," can add columns but they won't be typed. Always use ",(0,a.jsx)(e.code,{children:"annotate"})," for type-safe computed columns."]})}),"\n",(0,a.jsx)(e.hr,{}),"\n",(0,a.jsxs)(e.p,{children:["Next: ",(0,a.jsx)(e.a,{href:"/hysteria-orm/docs/databases/sql/models/hooks",children:"Model Hooks"})]})]})}function u(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(c,{...n})}):c(n)}},8453:(n,e,t)=>{t.d(e,{R:()=>i,x:()=>r});var o=t(6540);const a={},s=o.createContext(a);function i(n){const e=o.useContext(s);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:i(n.components),o.createElement(s.Provider,{value:e},n.children)}}}]);