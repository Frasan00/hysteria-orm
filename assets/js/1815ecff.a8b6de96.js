"use strict";(self.webpackChunkhysteria_orm_docs=self.webpackChunkhysteria_orm_docs||[]).push([[8174],{8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var t=s(6540);const r={},i=t.createContext(r);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(i.Provider,{value:n},e.children)}},8604:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"databases/sql/advanced/json","title":"Advanced SQL Features: JSON Columns","description":"Store and query JSON data directly in your SQL tables. JSON columns are useful for flexible, semi-structured data that doesn\'t fit a rigid schema.","source":"@site/docs/databases/sql/advanced/json.md","sourceDirName":"databases/sql/advanced","slug":"/databases/sql/advanced/json","permalink":"/hysteria-orm/databases/sql/advanced/json","draft":false,"unlisted":false,"editUrl":"https://github.com/Frasan00/hysteria-orm/tree/main/website/docs/databases/sql/advanced/json.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Advanced SQL Features: JSON Columns","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Advanced SQL Features: CTE","permalink":"/hysteria-orm/databases/sql/advanced/cte"},"next":{"title":"SQLite JSON Limitations","permalink":"/hysteria-orm/databases/sql/advanced/sqlite-json-limitations"}}');var r=s(4848),i=s(8453);const a={title:"Advanced SQL Features: JSON Columns",sidebar_position:2},l="JSON Columns",o={},c=[{value:"Feature Support Matrix",id:"feature-support-matrix",level:2},{value:"Basic JSON Filtering",id:"basic-json-filtering",level:2},{value:"Logical Operations (AND/OR)",id:"logical-operations-andor",level:2},{value:"Array and Object Filtering",id:"array-and-object-filtering",level:2},{value:"Data Variations",id:"data-variations",level:2},{value:"Bulk Operations",id:"bulk-operations",level:2},{value:"Advanced JSON Filters",id:"advanced-json-filters",level:2},{value:"Selecting JSON Columns",id:"selecting-json-columns",level:2},{value:"Extracting JSON Values",id:"extracting-json-values",level:2},{value:"<code>selectJson()</code> - Extract JSON Values",id:"selectjson---extract-json-values",level:3},{value:"<code>selectJsonText()</code> - Extract as Text",id:"selectjsontext---extract-as-text",level:3},{value:"<code>selectJsonArrayLength()</code> - Get Array Length",id:"selectjsonarraylength---get-array-length",level:3},{value:"<code>selectJsonKeys()</code> - Get Object Keys",id:"selectjsonkeys---get-object-keys",level:3},{value:"<code>selectJsonRaw()</code> - Raw SQL Expressions",id:"selectjsonraw---raw-sql-expressions",level:3},{value:"Combining JSON Methods",id:"combining-json-methods",level:3},{value:"Using with Raw QueryBuilder",id:"using-with-raw-querybuilder",level:3},{value:"Cross-Database Notes",id:"cross-database-notes",level:2},{value:"JSON Filtering",id:"json-filtering",level:3},{value:"JSON Extraction Methods",id:"json-extraction-methods",level:3},{value:"Path Format Standardization",id:"path-format-standardization",level:3},{value:"Type Safety",id:"type-safety",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"json-columns",children:"JSON Columns"})}),"\n",(0,r.jsx)(n.p,{children:"Store and query JSON data directly in your SQL tables. JSON columns are useful for flexible, semi-structured data that doesn't fit a rigid schema."}),"\n",(0,r.jsx)(n.h2,{id:"feature-support-matrix",children:"Feature Support Matrix"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"PostgreSQL"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"MySQL/MariaDB"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"SQLite"}),(0,r.jsx)(n.th,{style:{textAlign:"center"},children:"MSSQL"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Basic JSON equality (",(0,r.jsx)(n.code,{children:"whereJson"}),")"]}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Nested property match"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"~"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Array element match"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"~"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"AND/OR JSON conditions"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"~"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["JSON containment (",(0,r.jsx)(n.code,{children:"whereJsonContains"}),")"]}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2717"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"JSON IN/NOT IN"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Select JSON column"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Extract JSON values (",(0,r.jsx)(n.code,{children:"selectJson"}),")"]}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Extract as text (",(0,r.jsx)(n.code,{children:"selectJsonText"}),")"]}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"JSON array length"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2717"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"JSON object keys"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2713"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2717"}),(0,r.jsx)(n.td,{style:{textAlign:"center"},children:"\u2717"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["~ = Limited/partial support, see ",(0,r.jsx)(n.a,{href:"/hysteria-orm/databases/sql/advanced/sqlite-json-limitations",children:"SQLite JSON Limitations"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"basic-json-filtering",children:"Basic JSON Filtering"}),"\n",(0,r.jsx)(n.p,{children:"Query for full JSON object equality or by nested properties."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Full object equality\nawait User.query().whereJson("json", { foo: "bar", arr: [1, 2, 3] }).one();\n\n// Nested property (works best in PostgreSQL/MySQL)\nawait User.query().whereJson("json", { profile: { info: { age: 42 } } } ).one();\n'})}),"\n",(0,r.jsx)(n.h2,{id:"logical-operations-andor",children:"Logical Operations (AND/OR)"}),"\n",(0,r.jsxs)(n.p,{children:["Combine multiple JSON conditions using ",(0,r.jsx)(n.code,{children:"andWhereJson"})," and ",(0,r.jsx)(n.code,{children:"orWhereJson"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// AND combination\nawait User.query()\n  .whereJson("json", { logic: "A" })\n  .andWhereJson("json", { status: "active" })\n  .one();\n\n// OR combination\nawait User.query()\n  .whereJson("json", { logic: "A" })\n  .orWhereJson("json", { logic: "B" })\n  .many();\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," Complex AND/OR combinations are only fully supported in PostgreSQL/MySQL. SQLite has limited support. See ",(0,r.jsx)(n.a,{href:"/hysteria-orm/databases/sql/advanced/sqlite-json-limitations",children:"SQLite JSON Limitations"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"array-and-object-filtering",children:"Array and Object Filtering"}),"\n",(0,r.jsx)(n.p,{children:"Query by array elements or nested object properties in JSON columns."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Array element match (best in PostgreSQL/MySQL)\nawait User.query().whereJson("json", { tags: ["frontend", "typescript"] }).one();\n\n// Nested object property\nawait User.query().whereJson("json", { user: { profile: { settings: { theme: "dark" } } } }).one();\n'})}),"\n",(0,r.jsx)(n.h2,{id:"data-variations",children:"Data Variations"}),"\n",(0,r.jsx)(n.p,{children:"Insert and retrieve various JSON structures, including primitives and null."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const variants = [\n  { foo: "bar", arr: [1, 2, 3], nested: { a: 1 } },\n  { simple: "string value" },\n  { number: 12345 },\n  { bool: true },\n  null,\n];\nfor (const json of variants) {\n  await User.insert({ ...UserFactory.getCommonUserData(), json });\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"bulk-operations",children:"Bulk Operations"}),"\n",(0,r.jsxs)(n.p,{children:["Insert many users with different JSON values and query using ",(0,r.jsx)(n.code,{children:"whereJson"})," or ",(0,r.jsx)(n.code,{children:"whereJsonIn"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'await User.insertMany([\n  { ...UserFactory.getCommonUserData(), json: { bulk: 1 } },\n  { ...UserFactory.getCommonUserData(), json: { bulk: 2 } },\n]);\n\nawait User.query().whereJson("json", { bulk: 1 }).one();\nawait User.query().whereJsonIn("json", [{ bulk: 1 }, { bulk: 2 }]).many();\n'})}),"\n",(0,r.jsx)(n.h2,{id:"advanced-json-filters",children:"Advanced JSON Filters"}),"\n",(0,r.jsx)(n.p,{children:"Use containment and negation for advanced filtering (PostgreSQL/MySQL only)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Containment (not supported in SQLite)\nawait User.query().whereJsonContains("json", { arr: [1, 2, 3] }).one();\nawait User.query().whereJsonNotContains("json", { arr: [1, 2, 3] }).one();\n\n// Negation\nawait User.query().whereNotJson("json", { foo: "bar" }).one();\n'})}),"\n",(0,r.jsx)(n.h2,{id:"selecting-json-columns",children:"Selecting JSON Columns"}),"\n",(0,r.jsx)(n.p,{children:"Select only the JSON column or combine with other columns."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Select only JSON\nawait User.query().select("json").where("email", "=", user.email).one();\n\n// Select JSON and another column\nawait User.query().select("json", "email").where("email", "=", user.email).one();\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"extracting-json-values",children:"Extracting JSON Values"}),"\n",(0,r.jsxs)(n.p,{children:["The ORM provides powerful methods to extract specific values from JSON columns directly in your queries. All extracted values are available in the ",(0,r.jsx)(n.code,{children:"$annotations"})," property of the returned model."]}),"\n",(0,r.jsxs)(n.h3,{id:"selectjson---extract-json-values",children:[(0,r.jsx)(n.code,{children:"selectJson()"})," - Extract JSON Values"]}),"\n",(0,r.jsx)(n.p,{children:"Extract a JSON value at a specific path and return it as JSON. The path format is standardized across all databases."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const user = await User.query()\n  .selectJson("data", "$.user.name", "userName")\n  .selectJson("data", "$.settings.theme", "userTheme")\n  .one();\n\nconsole.log(user?.$annotations?.userName);  // "John Doe"\nconsole.log(user?.$annotations?.userTheme); // "dark"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Path Format Options:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["With ",(0,r.jsx)(n.code,{children:"$"})," prefix: ",(0,r.jsx)(n.code,{children:'"$.user.name"'})]}),"\n",(0,r.jsxs)(n.li,{children:["Without ",(0,r.jsx)(n.code,{children:"$"})," prefix: ",(0,r.jsx)(n.code,{children:'"user.name"'})]}),"\n",(0,r.jsxs)(n.li,{children:["Array notation: ",(0,r.jsx)(n.code,{children:'["user", "name"]'})]}),"\n",(0,r.jsxs)(n.li,{children:["Array indices: ",(0,r.jsx)(n.code,{children:'"items.0.name"'})," or ",(0,r.jsx)(n.code,{children:'["items", 0, "name"]'})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// All these are equivalent\nawait User.query().selectJson("data", "$.profile.age", "age").one();\nawait User.query().selectJson("data", "profile.age", "age").one();\nawait User.query().selectJson("data", ["profile", "age"], "age").one();\n\n// Array access\nawait User.query()\n  .selectJson("data", "items.0.name", "firstItem")\n  .selectJson("data", ["items", 1, "price"], "secondItemPrice")\n  .one();\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"selectjsontext---extract-as-text",children:[(0,r.jsx)(n.code,{children:"selectJsonText()"})," - Extract as Text"]}),"\n",(0,r.jsx)(n.p,{children:"Extract a JSON value and return it as plain text (unquoted string)."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const user = await User.query()\n  .selectJsonText("data", "$.user.email", "email")\n  .selectJsonText("data", "user.bio", "biography")\n  .one();\n\nconsole.log(user?.$annotations?.email);     // "john@example.com" (string)\nconsole.log(user?.$annotations?.biography); // "Software Developer" (string)\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Use cases:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"When you need string values without JSON formatting"}),"\n",(0,r.jsx)(n.li,{children:"Extracting text from deeply nested objects"}),"\n",(0,r.jsx)(n.li,{children:"Getting array elements as strings"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Extract array elements as text\nconst result = await User.query()\n  .selectJsonText("data", "tags.0", "firstTag")\n  .selectJsonText("data", ["tags", 1], "secondTag")\n  .one();\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"selectjsonarraylength---get-array-length",children:[(0,r.jsx)(n.code,{children:"selectJsonArrayLength()"})," - Get Array Length"]}),"\n",(0,r.jsx)(n.p,{children:"Get the length of a JSON array."}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," Not supported in SQLite"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const user = await User.query()\n  .selectJsonArrayLength("data", "$.items", "itemCount")\n  .selectJsonArrayLength("data", "user.roles", "roleCount")\n  .one();\n\nconsole.log(user?.$annotations?.itemCount); // 5\nconsole.log(user?.$annotations?.roleCount); // 2\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Special paths:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Root array: Use ",(0,r.jsx)(n.code,{children:'"$"'})," or ",(0,r.jsx)(n.code,{children:'""'})]}),"\n",(0,r.jsx)(n.li,{children:"Nested arrays: Use dot notation"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// Root array\nawait User.query().selectJsonArrayLength("data", "$", "totalCount").one();\n\n// Deeply nested\nawait User.query()\n  .selectJsonArrayLength("data", "level1.level2.array", "deepArrayCount")\n  .one();\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"selectjsonkeys---get-object-keys",children:[(0,r.jsx)(n.code,{children:"selectJsonKeys()"})," - Get Object Keys"]}),"\n",(0,r.jsx)(n.p,{children:"Get all keys from a JSON object."}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," Not supported in SQLite or MSSQL"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const user = await User.query()\n  .selectJsonKeys("data", "$.settings", "settingKeys")\n  .selectJsonKeys("data", "$", "rootKeys")\n  .one();\n\nconsole.log(user?.$annotations?.settingKeys); // ["theme", "fontSize", "autoSave"]\nconsole.log(user?.$annotations?.rootKeys);    // ["user", "settings", "metadata"]\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"PostgreSQL vs MySQL:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PostgreSQL:"})," Returns a native array"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MySQL:"})," Returns a JSON array"]}),"\n"]}),"\n",(0,r.jsxs)(n.h3,{id:"selectjsonraw---raw-sql-expressions",children:[(0,r.jsx)(n.code,{children:"selectJsonRaw()"})," - Raw SQL Expressions"]}),"\n",(0,r.jsx)(n.p,{children:"Use database-specific JSON expressions for advanced use cases."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'// PostgreSQL\nconst result = await User.query()\n  .selectJsonRaw("data->>\'email\'", "userEmail")\n  .one();\n\n// MySQL\nconst result = await User.query()\n  .selectJsonRaw("JSON_UNQUOTE(JSON_EXTRACT(data, \'$.email\'))", "userEmail")\n  .one();\n'})}),"\n",(0,r.jsx)(n.h3,{id:"combining-json-methods",children:"Combining JSON Methods"}),"\n",(0,r.jsx)(n.p,{children:"Mix multiple JSON extraction methods in a single query:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const user = await User.query()\n  .select("email", "name")  // Regular columns\n  .selectJson("data", "user.profile", "profile")\n  .selectJsonText("data", "user.bio", "biography")\n  .selectJsonArrayLength("data", "user.roles", "roleCount")\n  .selectJsonKeys("data", "settings", "settingKeys")\n  .where("email", "user@example.com")\n  .one();\n\n// Access all values\nconsole.log(user?.email);                         // Regular column\nconsole.log(user?.$annotations?.profile);         // JSON object\nconsole.log(user?.$annotations?.biography);       // String\nconsole.log(user?.$annotations?.roleCount);       // Number\nconsole.log(user?.$annotations?.settingKeys);     // Array\n'})}),"\n",(0,r.jsx)(n.h3,{id:"using-with-raw-querybuilder",children:"Using with Raw QueryBuilder"}),"\n",(0,r.jsxs)(n.p,{children:["JSON extraction methods also work with raw ",(0,r.jsx)(n.code,{children:"SqlDataSource.query()"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const result = await sqlDataSource\n  .query("users")\n  .selectJson("data", "user.name", "userName")\n  .selectJsonText("data", "user.email", "userEmail")\n  .where("id", 1)\n  .one();\n\n// With raw queries, values are at root level (no $annotations)\nconsole.log(result?.userName);  // Direct access\nconsole.log(result?.userEmail); // Direct access\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"cross-database-notes",children:"Cross-Database Notes"}),"\n",(0,r.jsx)(n.h3,{id:"json-filtering",children:"JSON Filtering"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PostgreSQL/MySQL/MariaDB/MSSQL:"})," Full support for advanced JSON queries, containment, and deep property matching."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SQLite:"})," Only supports basic equality and simple queries. Advanced features (containment, deep property, array matching) are limited or unsupported. See ",(0,r.jsx)(n.a,{href:"/hysteria-orm/databases/sql/advanced/sqlite-json-limitations",children:"SQLite JSON Limitations"})," for details."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"json-extraction-methods",children:"JSON Extraction Methods"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PostgreSQL/CockroachDB:"})," Full support for all JSON extraction methods. Uses native JSON operators (",(0,r.jsx)(n.code,{children:"->"}),", ",(0,r.jsx)(n.code,{children:"->>"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MySQL/MariaDB:"})," Full support with bracket notation for array indices (",(0,r.jsx)(n.code,{children:"$.items[0]"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MSSQL:"})," Full support except ",(0,r.jsx)(n.code,{children:"selectJsonKeys()"}),". Uses bracket notation for arrays"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SQLite:"})," Supports basic extraction (",(0,r.jsx)(n.code,{children:"selectJson"}),", ",(0,r.jsx)(n.code,{children:"selectJsonText"}),") but not array length or object keys"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"path-format-standardization",children:"Path Format Standardization"}),"\n",(0,r.jsx)(n.p,{children:"The ORM automatically converts your path format to the appropriate database-specific syntax:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Input:"})," ",(0,r.jsx)(n.code,{children:'"items.0.name"'})," or ",(0,r.jsx)(n.code,{children:'["items", 0, "name"]'})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"PostgreSQL:"})," ",(0,r.jsx)(n.code,{children:"->'items'->0->>'name'"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"MySQL/MSSQL:"})," ",(0,r.jsx)(n.code,{children:"$.items[0].name"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SQLite:"})," ",(0,r.jsx)(n.code,{children:"$.items.0.name"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This means you write your queries once and they work across all supported databases."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"type-safety",children:"Type Safety"}),"\n",(0,r.jsxs)(n.p,{children:["When using ",(0,r.jsx)(n.code,{children:"ModelQueryBuilder"}),", TypeScript will infer the types of your annotations:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",children:'const user = await User.query()\n  .selectJson("data", "user.name", "userName")\n  .selectJsonText("data", "user.email", "userEmail")\n  .selectJsonArrayLength("data", "items", "itemCount")\n  .one();\n\n// TypeScript knows these types:\nuser?.$annotations?.userName;   // any\nuser?.$annotations?.userEmail;  // string\nuser?.$annotations?.itemCount;  // number\n'})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:"See also:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/hysteria-orm/databases/sql/advanced/cte",children:"CTE"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/hysteria-orm/databases/sql/advanced/transactions",children:"Transactions"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/hysteria-orm/databases/sql/advanced/sqlite-json-limitations",children:"SQLite JSON Limitations"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);